---
title: "Cellchat V2 Viz among NTC samples"
format: pdf
---

This report serves as a preliminary validation for layer-layer communicaiton analysis using cellchat v2. The purpose for these viz is to support the claim that layer-layer communication is legit as an extension of cell-cell communication. The _Objective_ for this report is to validate that certain established communication between layers, e.g. layer to layer projects, can be detected in our dataset via `cellchat`.

This report focus on the analysis among _NTC_ samples. 


## Code 
```{r load_library, echo = FALSE}
suppressPackageStartupMessages({
  library(here)
  library(CellChat)
  library(tidyverse)
  library(patchwork)
})
```

```{r load_merged_cell_chat, echo = FALSE}
cellchat <- readRDS(
  here(
    "processed-data/layer_layer_comm",
    "ntc_cellchat.rds"
  )
)
 # number of cells in each cell group
groupSize <- as.numeric(table(cellchat@idents))
```

# Results


## GABA pathways
```{r}
netVisual_aggregate(cellchat, signaling = "GABA-A")
```

```{r}
netVisual_heatmap(cellchat, signaling = "GABA-A", color.heatmap = "Reds")
```

### LR pairs in the `GABA_A` path
Here is a list of contirbuting LR pairs that are in the `GABA_A` pathway.
```{r, fig.height = 6}
netAnalysis_contribution(cellchat, signaling = "GABA-A")
```

```{r, fig.height = 12}
netVisual_bubble(cellchat, signaling = "GABA-A", remove.isolate = FALSE)
```

### (Supp Material) LR paris GABA-A pathways in the cellphoneDB
Listing all the LR pairs in the GABA-A pathways in the data bases
```{r}
# dplyr::glimpse(CellChatDB$interaction)
CellChatDB <- CellChatDB.human
rownames(CellChatDB$interaction) <- NULL
CellChatDB$interaction[
  grep("GABA-A", CellChatDB$interaction$pathway_name, ignore.case = T),
c("pathway_name","ligand", "receptor", "annotation")
] 
```



## SST pathways
There is no significant communication of SOMATOSTATIN signaling pathway

```{r}
# netVisual_aggregate(cellchat, signaling = "SOMATOSTATIN")
```

### confirm SST pathways are in the cellphoneDB
Confirm there's SST related LR pair in the database cell chat used to  in the database. 
```{r}
# dplyr::glimpse(CellChatDB$interaction)
CellChatDB <- CellChatDB.human
CellChatDB$interaction[
  grep("SST", CellChatDB$interaction$ligand, ignore.case = T),
c("interaction_name", "pathway_name")
] 
```
